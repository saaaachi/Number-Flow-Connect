<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Flow Connect Maker - Arrow Edit -</title>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        #maker-grid { display: grid; background: #1e293b; gap: 4px; padding: 10px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .cell { width: 50px; height: 50px; background: #334155; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; }
        .cell:hover { background: #475569; }
        .controls { background: #1e293b; padding: 20px; border-radius: 12px; width: 350px; border: 1px solid #334155; }
        
        /* Áü¢Âç∞„Éú„Çø„É≥„ÅÆ„Çπ„Çø„Ç§„É´ */
        .selector-row { display: flex; align-items: center; justify-content: center; gap: 15px; margin: 10px 0; }
        .arrow-btn { background: #3b82f6; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .arrow-btn:active { transform: scale(0.9); background: #2563eb; }
        #num-display { font-size: 24px; font-weight: bold; width: 60px; text-align: center; }

        select, button { width: 100%; padding: 10px; margin: 5px 0; border-radius: 5px; border: none; font-size: 16px; }
        button { background: #22c55e; color: white; font-weight: bold; cursor: pointer; }
        #output { width: 100%; height: 120px; margin-top: 10px; background: #000; color: #0f0; font-family: monospace; font-size: 11px; padding: 10px; border-radius: 5px; overflow-y: auto; word-break: break-all; }
        .dot { width: 34px; height: 34px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid rgba(255,255,255,0.3); }
        .rock { font-size: 24px; }
    </style>
</head>
<body>
    <h2 style="color:#facc15;">üé® „Çπ„ÉÜ„Éº„Ç∏„É°„Éº„Ç´„Éº EX</h2>
    
    <div class="controls">
        <div style="text-align:center; font-size:14px; color:#94a3b8;">„Çµ„Ç§„Ç∫ÈÅ∏Êäû</div>
        <select id="size-select" onchange="initGrid()">
            <option value="5">5 x 5</option>
            <option value="6">6 x 6</option>
            <option value="7">7 x 7</option>
            <option value="8">8 x 8</option>
        </select>

        <div style="text-align:center; font-size:14px; color:#94a3b8; margin-top:15px;">ÈÖçÁΩÆ„Åô„ÇãÊï∞Â≠ó„ÇíÈÅ∏„Çì„Åß„Å≠ (0„ÅØÂ≤©ü™®)</div>
        <div class="selector-row">
            <button class="arrow-btn" onclick="changeNum(-1)">‚¨ÖÔ∏è</button>
            <div id="num-display">1</div>
            <button class="arrow-btn" onclick="changeNum(1)">‚û°Ô∏è</button>
        </div>
        
        <button onclick="copyToClipboard()" style="margin-top:10px;">„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº</button>
        <button onclick="initGrid()" style="background:#64748b; margin-top:10px;">„É™„Çª„ÉÉ„Éà</button>
    </div>

    <div id="maker-grid" style="margin-top:20px;"></div>
    <div id="output">[]</div>

    <script>
        let currentNum = 1;
        const colorPalette = {
            0: "#4b5563", 1: "#ef4444", 2: "#3b82f6", 3: "#22c55e", 4: "#facc15", 5: "#a855f7",
            6: "#ec4899", 7: "#06b6d4", 8: "#f97316", 9: "#8b5cf6", 10: "#10b981",
            11: "#fb7185", 12: "#6366f1", 13: "#fbbf24", 14: "#2dd4bf", 15: "#c026d3",
            16: "#94a3b8", 17: "#b91c1c", 18: "#1e3a8a", 19: "#14532d", 20: "#78350f"
        };
        let dots = [];

        function changeNum(dir) {
            currentNum += dir;
            if (currentNum < 0) currentNum = 20;
            if (currentNum > 20) currentNum = 0;
            document.getElementById('num-display').innerText = currentNum === 0 ? "ü™®" : currentNum;
        }

        function initGrid() {
            const size = document.getElementById('size-select').value;
            const grid = document.getElementById('maker-grid');
            grid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            grid.innerHTML = '';
            dots = [];
            updateOutput();
            for (let y = 0; y < size; y++) {
                for (let x = 0; x < size; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.onclick = () => placeDot(x, y, cell);
                    grid.appendChild(cell);
                }
            }
        }

        function placeDot(x, y, el) {
            const val = currentNum;
            const color = colorPalette[val];
            const existingIndex = dots.findIndex(d => d.x === x && d.y === y);
            
            if (existingIndex !== -1) {
                const existingDot = dots[existingIndex];
                dots.splice(existingIndex, 1);
                el.innerHTML = '';
                if (existingDot.val !== val) addDot(x, y, val, color, el);
            } else {
                addDot(x, y, val, color, el);
            }
            updateOutput();
        }

        function addDot(x, y, val, color, el) {
            dots.push({x, y, val, color});
            if (val === 0) el.innerHTML = `<span class="rock">ü™®</span>`;
            else el.innerHTML = `<div class="dot" style="background:${color}">${val}</div>`;
        }

        function updateOutput() {
            const size = document.getElementById('size-select').value;
            document.getElementById('output').innerText = JSON.stringify({ size: parseInt(size), dots: dots });
        }

        function copyToClipboard() {
            navigator.clipboard.writeText(document.getElementById('output').innerText).then(() => alert("„Ç≥„Éî„ÉºÂÆå‰∫ÜÔºÅ"));
        }

        initGrid();
    </script>
</body>
</html>
